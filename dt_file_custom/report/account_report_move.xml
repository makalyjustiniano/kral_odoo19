<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="papertformat_file_custom" model="report.paperformat">
        <field name="name">Comprobante Diario/Ingreso/Egreso</field>
        <field name="default" eval="False" />
        <field name="format">Letter</field>
        <field name="page_height">0</field>
        <field name="page_width">0</field>
        <field name="orientation">Portrait</field>
        <field name="margin_top">5</field>
        <field name="margin_bottom">25</field>
        <field name="margin_left">7</field>
        <field name="margin_right">7</field>
        <field name="header_line" eval="False" />
        <field name="header_spacing">10</field>
        <field name="dpi">90</field>
    </record>
    <record id="action_report_comprobante_accounting" model="ir.actions.report">
        <field name="name">Comprobante Contable</field>
        <field name="model">account.move</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">dt_file_custom.report_saleorder</field>
        <field name="report_file">dt_file_custom.report_saleorder</field>
        <field name="paperformat_id" ref="dt_file_custom.papertformat_file_custom"/>
        <!-- üîë ODOO 19 " -->
        <field name="binding_model_id" ref="account.model_account_move"/>
        <field name="binding_type">report</field>
        <field name="print_report_name">'Comprobante - %s' % (object.name)</field>
    </record>
    <template id="report_saleorder">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="dt_file_custom.report_saleorder_document" />
                <t t-set="lang_code" t-value="env.context.get('lang')" />
            </t>
        </t>
    </template>
    <!-- TEMPLATE QWEB -->
    <template id="report_saleorder_document">
        <t t-call="dt_file_custom.report_external_layout">
            <t t-esc-lang="es_BO" t-set="o" t-value="o.with_context({'lang':o.partner_id.lang})" />
            <t t-call="dt_file_custom.report_comprobante_accounting" />
        </t>
    </template>
    <template id="report_external_layout">
        <t t-if="not o and doc">
            <t t-set="o" t-value="doc" />
        </t>
        <t t-if="o and 'company_id' in o">
            <t t-set="company" t-value="o.company_id">
            </t>
        </t>
        <t t-if="not o or not 'company_id' in o">
            <t t-set="company" t-value="res_company">
            </t>
        </t>
        <div class="header">
            <div class="row">
                <div class="col-xs-9 text-left" style="margin-top:0px;"
                    t-field="company.report_header" />
            </div>
        </div>
        <div class="article o_report_layout_standard" style="maring-top: 100px;"
            t-att-data-oe-model="o and o._name" t-att-data-oe-id="o and o.id">
            <t t-call="web.address_layout" />
            <t t-raw="0" />
        </div>
        <div class="footer">
            <!--<div
            style="border-bottom: 1px solid black;">-->
            <div style="display: -webkit-box; width: 100%;">
                <div style="width: 50%">
                    <h4>
                        <strong style="font-size: 14px;"> Usuario: </strong>
                        <span style="font-size: 14px;" t-field="o.user_act"></span>
                    </h4>
                </div>
                <div t-if="report_type == 'pdf'" class="text-muted"
                    style="text-align: right; margin-top: 0px; width: 50%">
                    <strong style="color: black;"> P√°gina:
                        <span class="page" style="color: black;" />
                        de
                        <span style="color: black;" class="topage" />
                    </strong>
                </div>
            </div>
            <div style="margin-top:20px;">

            </div>
        </div>
    </template>
    <template id="report_comprobante_accounting">
        <style>
            th, td{
            border: none;
            }
            th, td {
            border: none;
            padding: 5px; /* Unificar padding */
        }
        /* Evita que las filas se partan a la mitad entre p√°ginas */
        tr {
            page-break-inside: avoid !important;
        }
        /* Asegura que la tabla respete los m√°rgenes */
        .table {
            width: 100%;
            margin-bottom: 20px;
            background-color: transparent;
            border-collapse: collapse; /* Importante para evitar lineas dobles */
        }
        /* Soluci√≥n para el encabezado encaramado: 
           A veces wkhtmltopdf repite el thead y lo superpone. 
           display: table-row-group evita que se repita el header en cada pagina
           si prefieres que NO se repita. Si quieres que se repita, usa table-header-group
           pero aseg√∫rate de tener margin-top suficiente en el body.
        */
        thead {
            display: table-header-group; 
        }
            
        </style>
        
        <!--   <t t-call="web.html_container">
            <t t-call="web.external_layout"> -->
        <div class="page">
            <div>
                <!-- Cabezera -->
                <div style="display: flex; display: -webkit-box;">
                    <div>
                        <img t-if="o.company_id.logo" t-att-src="image_data_uri(o.company_id.logo)"
                            style="max-height: 80px; max-width:90%" />
                    </div>
                    <div style="margin-left: 0px; width: 350px;">
                        <span style="text-transform: uppercase; font-size:14px;"
                            t-field="o.company_id.name" />
                        <br />
                        <span style="font-size:14px;">Tel√©fono: </span>
                        <span style="font-size:14px;"
                            t-field="o.phone_company" />
                        <br />
                        <span style="font-size:14px;">Direcci√≥n: </span>
                        <span style="font-size:14px;"
                            t-field="o.address_company" />
                    </div>
                </div>
                <div class="row zero_min_height" style="margin-top: 5px;">
                    <div class="col-xs-12" style="magin-top: 10px;">
                        <div style="border-bottom: 1px solid black; margin-top: 5px;">
                        </div>
                    </div>
                </div>
            </div>
            <div>
                <div t-if='o.journal_id.type == "sale" or o.journal_id.type == "purchase" or o.journal_id.type == "general"'
                    style="text-align: center; margin-top: 25px;">
                    <h5 style="margin-top: 20px; font-weight: 900;">
                        COMPROBANTE DE TRASPASO
                    </h5>
                </div>
                <div t-if='o.payment_type2 == "outbound" and o.journal_id.type == "bank"'
                    style="text-align: center; margin-top: 25px;">
                    <h5 style="margin-top: 20px; font-weight: 900;">
                        COMPROBANTE DE EGRESO
                    </h5>
                </div>
                <!-- 

                <div t-if='o.payment_type2 == "inbound_diario" or o.payment_type2 == "outbound_diario"'
                    style="text-align: center; margin-top: 25px;">
                    <h5 style="margin-top: 20px; font-weight: 900;">
                        COMPROBANTE DE DIARIO
                    </h5>
                </div>

                -->
                <div t-if='o.payment_type2 == "inbound" and o.journal_id.type == "bank"'
                    style="text-align: center; margin-top: 25px;">
                    <h5 style="margin-top: 20px; font-weight: 900;">
                        COMPROBANTE DE INGRESO
                    </h5>
                </div>
                <span style="font-weight: 900;"> Fecha Contable:
                    <span style="font-weight: normal;">
                        <span t-field="o.date_char"></span>
                    </span>
                </span>
                <br />
                <span style="font-weight: 900;"> Nro. Comprobante:
                    <span
                        style="font-weight: normal;">
                        <span t-field="o.name" />
                    </span>
                </span>
                <br />
                <span style="font-weight: 900;"> Referencia:
                    <span style="font-weight: normal;">
                        <span t-field="o.ref" />
                    </span>
                </span>
                <br />
                <span t-if='o.payment_type2 == "outbound"' style="font-weight: 900;"> Proveedor:
                    <span
                        style="font-weight: normal;">
                        <span t-field="o.invoice_line_ids.partner_id.name" />
                    </span>
                </span>
                <span t-if='o.payment_type2 == "inbound"'
                    style="font-weight: 900;"> Cliente:
                    <span style="font-weight: normal;">
                        <span t-field="o.invoice_line_ids.partner_id.name" />
                    </span>
                </span>
                <span t-if='o.payment_type2 == "outbound_diario" and o.move_type == "in_invoice"'
                    style="font-weight: 900;"> Proveedor:
                    <span style="font-weight: normal;">
                        <span t-field="o.invoice_line_ids.partner_id.name" />
                    </span>
                </span>
                <span t-if='o.payment_type2 == "inbound_diario" and o.move_type == "out_invoice"'
                    style="font-weight: 900;"> Cliente:
                    <span style="font-weight: normal;">
                        <span t-field="o.invoice_line_ids.partner_id.name" />
                    </span>
                </span>
                <br />
                <div style="width=100%;">
                    <span style="font-weight: 900;"> Moneda:
                        <span style="font-weight: normal;"
                            t-field="o.currency_id"></span>
                    </span>
                    <span style="font-weight: 900; margin-left: 79%;"> T.C.:
                        <span
                            style="font-weight: 900;" t-field="o.value_currency_dls"></span>
                    </span>
                </div>
                <div class="row zero_min_height" style="margin-top: 5px;">
                    <div class="col-xs-12" style="magin-top: 10px;">
                        <div style="border-bottom: 1px solid black; margin-top: 5px;">
                        </div>
                    </div>
                </div>
                <div>
                    <table class="table table-condensed" style="border: none;">
                        <thead style="border: none;">
                            <tr style="border: none; font-size: 12px;">
                                <th style="text-align: left;">Cuenta</th>
                                <th style="text-align: left;">Descripci√≥n</th>
                                <th style="text-align: left;">Detalle</th>
                                <th style="text-align: right;">Debe (Bs.)</th>
                                <th style="text-align: right;">Haber (Bs.)</th>
                                <th style="text-align: right;">Debe (Usd)</th>
                                <th style="text-align: right;">Haber (Usd)</th>
                            </tr>
                        </thead>
                        <tbody style="border: none; ">
                            <tr t-foreach="o.line_ids"
                                t-as="l"
                                style="border: none; font-size: 12px; ">
                                <td
                                    style="width: 8%; vertical-align: top; text-align: left; padding:5px; ">
                                    <span t-field="l.account_id.code" />
                                </td>
                                <td
                                    style="width: 20%; vertical-align: top; text-align: left; padding:5px;">
                                    <span t-field="l.translate_description" t-esc="lang_code" />
                                </td>
                                <td style="width: 27%;  text-align: left; padding:5px;">
                                    <span t-field="l.name" />
                                </td>
                                <td
                                    style="width: 11%; vertical-align: top; text-align: right; padding:5px;">
                                    <span t-if='l.pivot_debito != 0.00' t-field="l.pivot_debito" />
                                </td>
                                <td
                                    style="width: 15%; vertical-align: top; text-align: right; padding:5px;">
                                    <span t-if='l.pivot_credito != 0.00' t-field="l.pivot_credito" />
                                </td>
                                <td
                                    style="width: 11%; vertical-align: top; text-align: right; padding:5px;">
                                    <span t-if='l.debe_dls != 0.00' t-field="l.debe_dls"></span>
                                </td>
                                <td
                                    style="width: 11%; vertical-align: top; text-align: right; padding:5px;">
                                    <span t-if='l.haber_dls != 0.00' t-field="l.haber_dls"></span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

              
                <div class="row zero_min_height" style="margin-top: 5px;">
                    <div class="col-xs-12" style="magin-top: 10px;">
                        <div style="border-bottom: 1px solid black; margin-top: 5px;">
                        </div>
                    </div>
                </div>
                <table class="table table-condensed" style="margin-top: 10px;border: none;">
                    <thead style="border: none;">
                        <tr style="border: none; font-size: 12px;">
                            <th style="text-align: left;"></th>
                            <th style="text-align: left;"></th>
                            <th style="text-align: left;"></th>
                            <th style="text-align: right;"></th>
                            <th style="text-align: right;"></th>
                            <th style="text-align: right;"></th>
                            <th style="text-align: right;"></th>
                        </tr>
                    </thead>
                    <tbody style="border: none;">
                        <tr style="border: none;font-size: 12px;">
                            <td
                                style="width: 8%; vertical-align: top; text-align: left; padding:5px;">
                                <span style="color: white">0000000000</span>
                            </td>
                            <td
                                style="width: 20%; vertical-align: top; text-align: left; padding:5px;">
                                <span style="color: white">0000000000000000</span>
                            </td>
                            <td style="width: 27%;  text-align: right; padding:5px;">
                                <span style="font-weight: 900;">TOTAL: </span>
                            </td>
                            <td
                                style="width: 11%; vertical-align: top; text-align: right; padding:10px;">
                                <span t-field="o.pivot_total_debit"></span>
                            </td>
                            <td
                                style="width: 15%; vertical-align: top; text-align: right; padding:10px;">
                                <span t-field="o.pivot_total_credit"></span>
                            </td>
                            <td
                                style="width: 11%; vertical-align: top; text-align: right; padding:10px;">
                                <span t-field="o.total_debit_dls"></span>
                            </td>
                            <td
                                style="width: 11%; vertical-align: top; text-align: right; padding:10px;">
                                <span t-field="o.total_credit_dls"></span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div style="margin-top: 40px;">
                <span style="font-weight: 900;">Son:
                    <span style="font-weight: normal;"
                        t-field="o.total_literal">
                        <span style="font-weight: normal;"></span>
                    </span>
                </span>
                <span t-if='o.decimal_value != 0' t-field="o.decimal_value"></span>
                <span t-if='o.decimal_value == 0'>00</span>
                <span>/100 Bolivianos</span>
            </div>
        </div>
        <!--  </t>
</t> -->
    </template>
</odoo>